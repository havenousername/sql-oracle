-- Ordinary PL/SQL program  + Associative array/Record:

CREATE OR REPLACE FUNCTION greatest_non_trivial_divisor(n INTEGER) RETURN INTEGER IS 
    iter INTEGER(3) := 0;
BEGIN
    iter := n;
    while n % iter <> 0 LOOP
        n := n -1;
    END LOOP;
    
    return iter;
END;
/

SELECT greatest_non_trivial_divisor(6) from dual;

-- CREATE OR REPLACE PROCEDURE num_highdiv(n integer) IS

-- Cursors/ Select Into
CREATE OR REPLACE FUNCTION subord_sum(p_empno integer) RETURN INTEGER IS
    sum_mgr paltamas.emp.mgr%TYPE;
    sum_sum paltamas.emp.sal%TYPE;
    CURSOR subordinates_sum IS (SELECT mgr, SUM(sal) from paltamas.emp group by mgr);
    summation INTEGER := 0;
BEGIN
    OPEN subordinates_sum;
    LOOP
        FETCH subordinates_sum INTO  sum_mgr, sum_sum;
        EXIT WHEN subordinates_sum%NOTFOUND;
        IF sum_mgr = p_empno THEN 
            summation := sum_sum;
        END IF;
    END LOOP;
    RETURN summation;
END;
/

select * from paltamas.emp;
SELECT SUBORD_SUM()
